require('../../js/helpers').initTest() if not global.test

compile = (s) -> Koffee.compile s, bare:true

test "meta if", ->

    check = (c,p) -> 
        js = compile(c)
        if -1 == js.indexOf p
            eq js, p
            
    check "@if true then yes @else no", 'true;'
    check "@if 1 @then yes @else no", 'true;'
    check """
        @if 'a'
            'hello'
        @else 
            'world'""", "'hello'"
    # check "@if @debug @then yes @else no", 'if (this.debug)'
    
test "broken stuff", ->

    throws -> compile """
        class A
            @if: -> 'if'
    """

    throws -> compile """
        class A
            @: -> @if() == 'if'
            @if: -> 'if'
    """
    
    throws -> compile """
        class A
            @: -> @if?
    """
    